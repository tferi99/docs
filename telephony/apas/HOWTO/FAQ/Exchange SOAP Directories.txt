=========================
Exchange SOAP Directories
=========================

- Configuration of public folders
- Add contacts to public folders
- Private folders

---------------------------------------------------------------------------------------------------------------------------
Configuration of public folders
================================
- Pre-requisities:
	- Create a domain user and add to Domain Admins group in Active Directory.

		- AD/Active Directory Users and Computers
			- choose a folder
			- right-mouse/New/User
			- In user properties 'Member of...'

		!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! IMPORTANT NOTE !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
		Don't use Administrator for development purposes. It has a lot of permissions by default but sometimes it has limitations for security reasons
		(e.g. it cannot use for mailing and that's the reasonif you want to use it for accessing Public Folders).
		-------------------------------------------------------------------------------
		
	- Create a mailbox for new user in Exchange.

		- Exchange admin center/recipients/mailboxes
			- +/User mailbox
			- browse users
		

- Exchange
	- Create Public folder mailbox
	
		- Exchange admin center/public folders/public folder mailboxes
			- +
			- select OU
			- select mailbox database
		
		
	- Create Public Folders. Add multiple folders if you need it.
		
		- Exchange admin center/public folders/public folders
	
		
		
	- Add permission.
	
		EITHER add for all folders in a single step:
		
			- Exchange admin center/public folders/public folders
	
		OR set permissions on folder one-by-one
		
		
		TIP:
		
			Check permissions with cmdlet. Call 'Exchange Management Shell' on Exchange server (it's a special PowerShell) and run:
			
				Get-PublicFolder -Recurse | Get-PublicFolderClientPermission | Select-Object Identity,User,AccessRights,IsValid
				
					Identity User       AccessRights IsValid
					-------- ----       ------------ -------
					\        Default    {Author}        True
					\        Anonymous  {None}          True
					\        Apas Admin {Owner}         True
					\users   Default    {Author}        True
					\users   Anonymous  {None}          True
					\users   Apas Admin {Owner}         True
					
	- Enable mailing for folders
	
		Select a folder and set mailing on the right panel (Mail settings - Enabled/Disabled)
		
		
	

- APAS/Directory/Directories/
	- (Add)
	- Exchange SOAP Contacts
	
	
	- SOAP Service URL - format: 	https://<EXCHANGE_SERVER>/EWS/Exchange.asmx
	- Login: User account is used for Exchange SOAP authentication. Format: user@domain
	- Folder name:
		- contactsroot: with this name APAS will get content of all public folders under root public folder recursively

		
- Command line solution		
	You can do the same actions in CLI.
	
	Don't use simple PowerShell but Exchange Management Shell (special PowerShell).
	Here are some usable commmands:
	
		New-Mailbox –PublicFolder –Name 'TestPFMB' –Database 'Mailbox Database 0917630365'

		Get-OrganizationConfig | Select *public*
		Get-Mailbox –PublicFolder | FL Name, ExchangeGuid

		Get-OrganizationConfig | Format-List RootPublicFolderMailbox

		Get-mailbox –PublicFolder 'DevPFMB' | fl Name, SamAccountName, IsShared, ExchangeUserAccountControl, RecipientTypeDetails

		<manually created 'Exchange Team' before
		New-PublicFolder "Migration" –path '\Exchange Team'
		New-PublicFolder "Network Team" –Mailbox 'TestPFMB'

		Get-PublicFolder -Recurse
		Get-Mailbox –PublicFolder | Get-MailboxStatics | Select DisplayName, TotalItemSize

		$Perms = Get-ManagementRole -Cmdlet Get-MailboxStatics 
		$Perms | foreach {Get-ManagementRoleAssignment -Role $_.Name -Delegating $false | Format-Table -Auto Role,RoleAssigneeType,RoleAssigneeName}

		Get-PublicFolder -Identity "\Exchange Team" | FL
		Get-PublicFolder -Identity "\Exchange Team\Migration" | FL

		Get-OrganizationConfig  | fl *public*
		Get-PublicFolder -Recurse | Get-PublicFolderClientPermission | Select-Object Identity,User,AccessRights,IsValid
		Get-PublicFolderStatistics

		
SEE ALSO:

	images/exchange-soap-dir1.jpg
	tools_and_languages\telephony\apas\doc\02_ADMIN-DIR_5.6_enA4.pdf 
	tools_and_languages\telephony\apas\config\Public Folders in Exchange 2016 – Everything you need to know!.pdf


---------------------------------------------------------------------------------------------------------------------------
Add contacts to public folders
==============================
Pre-requisities:	configured Outlook desktop application configured with user who is an Owner of public folders.

NOTE:	
You need a domain user for Outlook and it important to login with the same user into Windows (with the same domain).
That means you Windows also should be this domain.

- Create new public folder in root public folder or in existig one. 

	Folder contains: Contact Items

- Go to this folder and add new contacts into it.


---------------------------------------------------------------------------------------------------------------------------
Private folders	
===============
- You can create also private folders in Outlook (folders not under Public Folders Root).
- Limitation in APAS: folders only can be siblings of contacts, sub-irectories and recursive fetch not supported.





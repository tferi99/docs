=========
=========
SIP QUICK
=========

- Abbreviations
- Mi a SIP - Session Initiation Protocol?
- SIP protocols
- SIP v·laszok
- SIP protocols
- Transaction

--------------------------------------------------------------------------------------------------------------------------
Abbreviations
=============
CTI - Computer telephony integration

SIP - Session Initiation Protocol

PSTN - public switched telephone network
	Is the world's collection of interconnected voice-oriented public telephone networks, both commercial and government-owned. It's also referred to as the Plain Old Telephone Service (POTS). 
	It's the aggregation of circuit-switching telephone networks that has evolved from the days of Alexander Graham Bell. 
	Today, it is almost entirely digital in technology except for the final link from the central (local) telephone office to the user. 
	
POTS - Plain Old Telephone Service

DTMF - Dual-tone multi-frequency (DTMF) signaling is used for telephone signaling over the line in the voice-frequency band to the call switching center. 

SDP - Session Description Protocol (SDP)
	The SDP protocol is described in the RFC4566. It is used to negotiate session
	parameters between the user agents. Media details, transport addresses, and other
	media-related information are exchanged between the user agents using the SDP protocol.

--------------------------------------------------------------------------------------------------------------------------
Mi a SIP - Session Initiation Protocol?
=======================================

A SIP a Session Initiation Protocol (HÌv·skezdemÈnyezo protokoll) rˆvidÌtÈse Ès egy IP telefonjel-·tviteli protokoll, amelyet VOIP telefonhÌv·sok lÈtrehoz·s·ra, 
mÛdosÌt·s·ra Ès bont·s·ra haszn·lnak. A SIP protokollt az IETF fejlesztette ki Ès RFC 3261 nÈv alatt tette kˆzzÈ.

A SIP a telefonhÌv·s lÈtrehoz·s·hoz sz¸ksÈges kommunik·ciÛt Ìrja le. A tov·bbi rÈszleteket az SDP protokoll Ìrja le.

A SIP szÈlviharkÈnt hatott a VOIP vil·gra. A protokoll hasonlÌt a HTTP protokollhoz, szˆvegalap˙ Ès rendkÌv¸l nyitott Ès rugalmas. 
EzÈrt majdnem teljesen helyettesÌtette a H323 szabv·nyt.
	

--------------------------------------------------------------------------------------------------------------------------
SIP protocols
=============
SIP is an application layer ptotocol.

- SIP
	SIP is primarily used in setting up and tearing down voice or video calls.	
	
- RTP
	The voice and video stream communications in SIP applications are carried over another application protocol, the Real-time Transport Protocol. 
	
- SDP	
	Parameters (port numbers, protocols, codecs) for these media streams are defined and negotiated using the
	Session Description Protocol (SDP) which is transported in the SIP packet body.

	SDP contains
		- Type of media (video, audio)
		- Transport (RTP, H.320, ...)
		- Format (H.261, MPEG, ...)
		- Remote IP address
		- Remote Port
		
- TLS
	If secure transmission is required, the scheme sips: is used and mandates that each hop over which the request is
	forwarded up to the target domain must be secured with Transport Layer Security (TLS).
	
	IP ---------------
	|  UDP -----------
	|  |  SIP --------
	|  |  |  | SDP ---
	|  |  |  | |
	|  |  |  | |------
	|  |  |  |--------
	|  |  |-----------
	|  |--------------
	|-----------------
	
SIP contains:
	Åo Command/Response
	Åo ID for transaction
	Åo Source
	Åo Destination
	Åo Route details
	Åo Data (i.e. SDP packet)	
	
SDP contains
	Åo Type of media (video, audio)
	Åo Transport (RTP, H.320, ...)
	Åo Format (H.261, MPEG, ...)
	Åo Remote IP address
	Åo Remote Port	
	
	
	
--------------------------------------------------------------------------------------------------------------------------
SIP participants
================

UA - A SIP user agent (UA) 
	is a logical network end-point used to create or receive SIP messages and thereby manage a SIP session.

UAC - User Agent Client (UAC), which sends SIP requests

UAS - User Agent Server (UAS), which receives the requests and returns a SIP response

	Note:
		These roles of UAC and UAS only last for the duration of a SIP transaction.

Proxy server
	An intermediary entity that acts as both a server (UAS) and a client (UAC) for the purpose of making requests on
	behalf of other clients. A proxy server primarily plays the role of routing, which means its job is to ensure that a
	request is sent to another entity "closer" to the targeted user.	

	
	
User Agent Client (UAC): A user agent client is a logical entity
         that creates a new request, and then uses the client
         transaction state machinery to send it.  The role of UAC lasts
         only for the duration of that transaction.  In other words, if
         a piece of software initiates a request, it acts as a UAC for
         the duration of that transaction.  If it receives a request
         later, it assumes the role of a user agent server for the
         processing of that transaction.

User Agent Server (UAS): A user agent server is a logical entity
         that generates a response to a SIP request.  The response
         accepts, rejects, or redirects the request.  This role lasts
         only for the duration of that transaction.  In other words, if
         a piece of software responds to a request, it acts as a UAS for
         the duration of that transaction.  If it generates a request
         later, it assumes the role of a user agent client for the
         processing of that transaction.

Proxy, Proxy Server: An intermediary entity that acts as both a
         server and a client for the purpose of making requests on
         behalf of other clients.  A proxy server primarily plays the
         role of routing, which means its job is to ensure that a
         request is sent to another entity "closer" to the targeted
         user.  Proxies are also useful for enforcing policy (for
         example, making sure a user is allowed to make a call).  A
         proxy interprets, and, if necessary, rewrites specific parts of
         a request message before forwarding it.

Registrar: A registrar is a server that accepts REGISTER requests
         and places the information it receives in those requests into
         the location service for the domain it handles.

Location Service: A location service is used by a SIP redirect or
         proxy server to obtain information about a callee's possible
         location(s).  It contains a list of bindings of address-of-
         record keys to zero or more contact addresses.  The bindings
         can be created and removed in many ways; this specification
         defines a REGISTER method that updates the bindings.

Back-to-Back User Agent: A back-to-back user agent (B2BUA) is a
         logical entity that receives a request and processes it as a
         user agent server (UAS).  In order to determine how the request
         should be answered, it acts as a user agent client (UAC) and
         generates requests.  Unlike a proxy server, it maintains dialog
         state and must participate in all requests sent on the dialogs
         it has established.  Since it is a concatenation of a UAC and
         UAS, no explicit definitions are needed for its behavior.

	
--------------------------------------------------------------------------------------------------------------------------
SIP message
===========
- SIP is a text-based protocol with syntax similar to that of HTTP. 

- There are two different types of SIP messages:
	- requests
	- responses
	
- The first line of a request has a 
	- METHOD, defining the nature of the request, and a
	- REQUEST-URI, indicating where the request should be sent.
	
- The first line of a response has a RESPONSE CODE.	

- SIP requests
	ï REGISTER: Used by a UA to indicate its current IP address and the URLs for which it would like to receive calls.
	
	ï INVITE: Used to establish a media session between user agents.
	
	ï ACK: Confirms reliable message exchanges.
	
	ï CANCEL: Terminates a pending request.
	
	ï BYE: Terminates a session between two users in a conference.
	
	ï OPTIONS: Requests information about the capabilities of a caller, without setting up a call.
	
	ï PRACK (Provisional Response Acknowledgement): PRACK improves network reliability by adding an
		acknowledgement system to the provisional Responses (1xx). PRACK is sent in response to provisional response

- The SIP response types defined in RFC 3261 fall in one of the following categories:[15]
	ï Provisional (1xx): Request received and being processed.
	ï Success (2xx): The action was successfully received, understood, and accepted.
	ï Redirection (3xx): Further action needs to be taken (typically by sender) to complete the request.
	ï Client Error (4xx): The request contains bad syntax or cannot be fulfilled at the server.
	ï Server Error (5xx): The server failed to fulfill an apparently valid request.
	ï Global Failure (6xx): The request cannot be fulfilled at any server.		
	
--------------------------------------------------------------------------------------------------------------------------
SIP v·laszok
============

1xx = t·jÈkoztatÛ v·laszok
100 PrÛb·lkoz·s 
180 CsengÈs 
181 A hÌv·s ·tir·nyÌtÛdik 
182 Sorba ·llÌtva 
183 Kapcsolat folyamatban 

2xx = sikeres kapcsolat v·laszok
200 OK 
202 elfogadva: Utal·sra haszn·lva 

3xx = ·tir·nyÌt·si v·laszok
300 Tˆbb lehetosÈg 
301 VÈgleg ·tir·nyÌtva 
302 Ideiglenesen ·tir·nyÌtva 
305 Proxy haszn·lata 
380 AlternatÌv szolg·ltat·s 

4xx = sikertelen kÈrÈsek
400 Hib·s kÈrÈs 
401 Nincs engedÈlyezve: Csak a rendszergazd·k haszn·lhatj·k. A proxy-knak a 407-es proxy engedÈlyt kell haszn·lniuk 
402 FizetÈs sz¸ksÈges (KÈsobbi haszn·latra fenntartva) 
403 Tiltott 
404 Nem tal·lhatÛ: A felhaszn·lÛ nem tal·lhatÛ 
405 A mÛdszer nincs engedÈlyezve 
406 Elfogadhatatlan 
407 Proxy hitelesÌtÈs sz¸ksÈges 
408 KÈrÈs idot˙llÈpÈs: A felhaszn·lÛt nem lehetett idoben megtal·lni 
410 Elkˆltˆzˆtt: A felhaszn·lÛ lÈtezett, de ezen a sz·mon tˆbbÈ nem Èrheto el. 
413 KÈrÈs entit·s t˙l nagy 
414 KÈrÈs URI t˙l hossz˙ 
415 Nem t·mogatott hordozÛtÌpus 
416 Nem t·mogatott URI sÈma 
420 Hib·s mellÈk: Hib·s SIP protokollmellÈket haszn·lt, a szerver nem tudja Èrtelmezni 
421 MellÈk sz¸ksÈges 
423 T˙l rˆvid idokˆz 
480 Pillanatnyilag nem elÈrheto 
481 A hÌv·s/tranzakciÛ nem lÈtezik 
482 Hurok jelentkezett 
483 T˙l sok akad·ly 
484 A cÌm nem teljes 
485 KÈtÈrtelmu 
486 Itt foglalt 
487 KÈrÈs megszakÌtva 
488 Itt elfogadhatatlan 
491 KÈrÈs folyamatban 
493 …rtelmezhetetlen: Az S/MIME testÈt nem siker¸lt kikÛdolni 

5xx = szerverhib·k
500 Belso szerverhiba 
501 Nincs bevezetve: A SIP kÈrÈsi mÛdszer nincs bevezetve itt 
502 Hib·s ·tj·rÛ 
503 A szolg·ltat·s nem elÈrheto 
504 Szerver idot˙llÈpÈs 
505 Ez a verziÛ nem t·mogatott: A szerver nem t·mogatja a SIP protokoll ezen verziÛj·t 
513 Az ¸zenet t˙l hossz˙ 

6xx = ·ltal·nos hib·k
600 Mindenhol foglalt 
603 VisszautasÌt·s 
604 Sehol sem lÈtezik 
606 Elfogadhatatlan


--------------------------------------------------------------------------------------------------------------------------
Transaction
===========
- SIP makes use of transactions to control the exchanges between participants and deliver messages reliably. The
	transactions maintain an internal state and make use of timers. 
	
- Client Transactions send requests 

- and Server Transactions respond to those requests with one-or-more responses. The responses may include zero-or-more
	Provisional (1xx) responses and one-or-more final (2xx-6xx) responses.

- Transactions are further categorized as either 
	- Invite 
	- or Non-Invite. 
	
- Invite transactions differ in that they can establish a long-running conversation, referred to as a Dialog in SIP, 
	and so include an acknowledgment (ACK) of any non-failing final response (e.g. 200 OK).

- Because of these transactional mechanisms, SIP can make use of un-reliable transports such as User Datagram Protocol (UDP).

	
